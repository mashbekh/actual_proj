<!DOCTYPE html>
<html lang="en">

<head>

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="author" content="">

<title>Register</title>

<script type="text/javascript"
	src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script
	src="http://ajax.aspnetcdn.com/ajax/jquery.ui/1.9.1/jquery-ui.js"
	type="text/javascript"></script>
<meta name="google-signin-client_id"
	content="230903295209-qfhj977v4aa60i0sjthdd0nuc0u1fkga.apps.googleusercontent.com">
<link
	href="http://ajax.aspnetcdn.com/ajax/jquery.ui/1.9.1/themes/blitzer/jquery-ui.css"
	rel="stylesheet" type="text/css" />


<script src="https://apis.google.com/js/platform.js" async defer></script>


<link rel="stylesheet"
	href="jarvis/js/datatables/responsive/css/datatables.responsive.css">

<!-- Bootstrap Core CSS -->
<link href="jarvis/css1/bootstrap.min.css" rel="stylesheet">

<!-- Custom CSS -->
<link href="jarvis/css1/sb-admin.css" rel="stylesheet">

<!-- Morris Charts CSS -->
<link href="jarvis/css1/plugins/morris.css" rel="stylesheet">

<!-- Custom Fonts -->
<link href="jarvis/css/font-icons/font-awesome/css/font-awesome.min.css"
	rel="stylesheet" type="text/css">

<link rel="stylesheet"
	href="jarvis/css/font-icons/entypo/css/entypo.css">



</head>



<script>
$(document).ready(function () {
    var $inputs = $("#register input");
    
    $inputs.on("input change", function () {
        valid = true;
        $inputs.each(function () {
           
            valid *= this.type == "radio" ? this.checked : this.value != "";
            return valid;
        });    
        $("#submit").prop("disabled", !valid);
    });
});

</script>

<script>

</script>

<script>


  
   
</script>

<style>
#pqr {
	background-color: #152F37;
}

#wrapper {
	background-color: white;
}

#pwrap {
	margin-top: 70px;
	background-color: white;
}

.ui-dialog-titlebar {
	border: 0;
	padding: .5em 1em;
	background: black;
	overflow: auto;
	zoom: 1;
}

#main {
	color: white;
	text-align: center;
}

#content {
	margin-left: 290px;
	font-size: 25px;
}


#errormsg {
	margin-left: 290px;
	font-size: 15px;
	font-color:red;
}


#form-panel {
	margin-left: 290px;
}
</style>



<body bgcolor="#E6E6FA" onload="renderButton()">

	<div id="wrapper">

		<!-- Navigation -->
		<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation"
			id="pqr">
			<h1 id="main">SIMPLIFY TAX</h1>
		</nav>



		<div class="container-fluid">

			<br> <br> <br>
			<p id="content">
				<b>Check out Simplify Tax — it’s free!</b><br> <br> More
				than two million freelancers, consultants,<br> and small
				business owners use Simplify Tax around the world.
			</p>
			
			<p id="errormsg">
			
			</p>

			<!-- Page Heading -->
			<div class="row">
				<div class="col-lg-6">

					<div id="form-panel">
						<div class="row">
							<div class="col-lg-12">
								<form role="form" id="register">



									<div class="form-group">
										<label></label> <input class="form-control" id="name"
											placeholder="User Name" required>
									</div>

									<div class="form-group">
										<label></label> <input class="form-control" type="text"
											id="email" placeholder="User Email"
											onchange="return verify_mail()" required>
										<div id="email_msg"></div>
									</div>

									<div class="form-group">
										<label></label> <input class="form-control" type="text"
											id="mobile" placeholder="Mobile No" required>
										<div id="email_msg"></div>
									</div>

									<div class="form-group">
										<label></label> <input class="form-control" type="password"
											id="password" placeholder="Password" required>
									</div>

									<div class="form-group">
										<label></label> <input class="form-control" type="password"
											id="confirm_password" placeholder="Confirm Password" required>
										<div id="password_verify"></div>
									</div>





								</form>

								<input type="submit" class="btn btn-primary" id="submit"
									onclick="return verify(this)" disabled="disabled"
									value="Lets get started!"> <br> <br> <br>
								<p>-------------or-------------</p>

								<div class="form-group">
									<label></label> <input class="form-control" type="text"
										id="mobileNo" placeholder="Mobile No" required>
									<div id="email_msg"></div>
								</div>

								<div class="form-group">
									<div id="google-signin-button"></div>

								</div>



								<br> <br> <br>

							</div>

						</div>
					</div>
					<!-- /.row -->

				</div>
				<!-- /.container-fluid -->

			</div>
			<!-- /#page-wrapper -->

		</div>
		<!-- /#wrapper -->

		<!-- jQuery 
    <script src="js/jquery.js"></script>-->

		<!-- Bootstrap Core JavaScript -->
		<script src="jarvis/js/bootstrap.min.js"></script>
</body>
<script>

function setCookie(key, value, days) {
    var expires = new Date();
    expires.setTime(expires.getTime() + (days * 24 * 60 * 60 * 1000));
    document.cookie = key + '=' + value + ';expires=' + expires.toUTCString();
}
     

function getCookie(key) {
    var keyValue = document.cookie.match('(^|;) ?' + key + '=([^;]*)(;|$)');
    return keyValue ? keyValue[2] : null;
}
function verify_mail()
{
 var reg = /^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;
var x= document.getElementById("email").value;
if(reg.test(x)== false)
 {
 
 $('#email_msg').text("Please enter valid email address");
 return false;
 }
else return true;

}
                              
                              
                              
   function verify(sender){
	
	var name = $('#name').val();
	var email = $('#email').val();
	
	var mobile = $('#mobile').val();
	var password  = $('#password').val();
	var confirm_password  = $('#confirm_password').val();
	
	
	
	var details={
			
		
		"userName":name,
		"userEmail":email,
		"password":password,
		"emailHexcode": null,
		"createdAt":null,
		"mobileNumber":mobile,
		"otp":0,
		"type":1, //normal user.
		"emailVerified": 0,
		"mobileVerified": 0,
		"id":null,
		"userStatus":0
	};
	
	setCookie('email', email,1);
	setCookie('mobile',mobile,1);
	var p = JSON.stringify(details);
	
  if (password === confirm_password){
	  
	  alert("yes");
   		$.ajax({
   		type : 'POST',
   		url  : '/Accounting/rest/register/add',
   		contentType: "application/json; charset=utf-8",
    	data: p,
    	dataType : "text",
  
 		success: function(response, text, xhr) {
          
 			console.log("id " +  response);
 			setCookie('identifier',response);
 			setCookie('mailCode',1);
            window.location.replace("confirmMail.html");
           return false;
    },
    
    error: function (xhr, statusText) {
		
	  
	    console.log(xhr.status);
	    var code = xhr.status;
	    
	    if(code == 432)
	    	{
	    	 $("#errormsg").append("User exists with given email and mobileNo. Please try again!");
	    	 setCookie('email',"",-1);
	    	 setCookie('mobile',"",-1);
	    	 $("#register").trigger('reset'); 
	    	}
	    
	    if(code == 433)
	    	{
	    	 $("#errormsg").append("User exists with given email. Please try again!");
	    	 setCookie('email',"",-1);
	    	 setCookie('mobile',"",-1);
	    	 $("#register").trigger('reset'); 
	    	}
	    
	    if(code == 434)
    	{
    	 $("#errormsg").append("User exists with given mobileNo. Please try again!");
    	 setCookie('email',"",-1);
    	 setCookie('mobile',"",-1);
    	 $("#register").trigger('reset'); 
    	}
	    
	    if(code == 435)
    	{
	     
    	 $("#errormsg").append("Given email and mobileNo is under verification. Please try again later!");
    	 setCookie('email',"",-1);
    	 setCookie('mobile',"",-1);
    	 $("#register").trigger('reset'); 
    	}
	    
	    if(code == 436)
    	{
    	 $("#errormsg").append("Given email is under verification. Please try again later!");
    	 setCookie('email',"",-1);
    	 setCookie('mobile',"",-1);
    	 $("#register").trigger('reset'); 
    	}
	    
	    if(code == 437)
    	{
    	 $("#errormsg").append("Given mobileNo is under verification. Please try again later!");
    	 setCookie('email',"",-1);
    	 setCookie('mobile',"",-1);
    	 $("#register").trigger('reset'); 
    	}
	    
	    
	    if(code == 438 || code == 439 || code == 440 )
    	{
    	 $("#errormsg").append("Oops, something went wrong! Please try again.");
    	 setCookie('email',"",-1);
    	 setCookie('mobile',"",-1);
    	 $("#register").trigger('reset'); 
    	}
	    
	    
	    if(code == 516 || code == 500)
	    	{
	    	  if(xhr.responseText == null)
	    		  {
	    		     $("#errormsg").append("Oops, something went wrong! Please try again.");
	    	    	 setCookie('email',"",-1);
	    	    	 setCookie('mobile',"",-1);
	    	    	 $("#register").trigger('reset'); 
	    		  }
	    	  else
	    		  {
	    		     setCookie('identifier',statusText,1);
	    		     setCookie('mailCode',0,1);
	    		    window.location.replace("confirmMail.html");
	    		  }
	    	}
	    
	    if(code == 515)
	    	{
	    	
	    	 setCookie('identifier',xhr.responseText,1);
		     setCookie('mailCode',0,1);
		     window.location.replace("confirmMail.html");
	    	}
	    
	  
	   return false;
	  }
    
	  });
          
            }
            else
            {
            //alert("no match");
             $('#password_verify').text("Passwords don't match");
             return false;
   }
  
}
                              
                              </script>


<script>
                              
      var count=0; 
      var state;
    function onSignIn(googleUser) 
    {
    	
    	count= count+1;
    	
    	if( state ==2 && count!=1 || state == 1)  //count is 2
    	{
    		if($("#mobileNo").val() == '')
    			{
        			alert("Please enter mobile number");
    				console.log("pls enter");   //already logged in here
    				signOut();
          	  		state =2; //sign him out
          	  		
    			}
    		else
    		{
    		alert('Logged in as: ' + googleUser.getBasicProfile().getName());
    		var name = googleUser.getBasicProfile().getName();
        	var email = googleUser.getBasicProfile().getEmail();
        	var mobile = $("#mobileNo").val();

    		var details = {
    			
    		
    		"userName":name,
    		"userEmail":email,
    		"password": null,
    		"emailHexcode": null,
    		"createdAt":null,
    		"mobileNumber":mobile,
    		"otp":0,
    		"type":2, //normal user.
    		"emailVerified": 1,
    		"mobileVerified": 0,
    		"id":null,
    		"userStatus":0
    	};
    	
    	var p = JSON.stringify(details);
    	console.log(p);
    	
    	$.ajax({
     		type : 'POST',
     		url  : '/Accounting/rest/register/add',
     		contentType: "application/json; charset=utf-8",
      	data: p,
      	dataType : "json",
    
   		success: function(response, text, xhr) {
             
             console.log(xhr.status);
             console.log(text);
             console.log(response);
           
             return false;
      },
      
      error: function (xhr, statusText) {
  		
  	    console.log(xhr);
  	    console.log(xhr.responseText);
  	    console.log(xhr.status);
  	    var code = xhr.status;
  	  if(code == 435)
  		{		  
  			 setCookie('errormsg',"Given email and mobileNo is under verification. Please try again later!",1);
  	 		 setCookie('email',"",-1);
  	 		 setCookie('mobile',"",-1);
  	 		 window.location.replace("register.html");
  	 
  	    }
  	   return false;
  	  }
      
  	  });
    		}
    	  }
    }
    
    
  
    function onFailure(error) {
      console.log(error);
    }
    function renderButton() {
    	
    	//clear all other cookies
    	
    	setCookie('email',"",-1);
    	setCookie('newemail',"",-1);
    	setCookie('mobile',"",-1);
    	setCookie('identifier',"",-1);
    	setCookie('mailCode',"",-1);
    	setCookie('mobCode',"",-1);
    
    	var error = getCookie('conferror');
    	if(error == 'notfound')
    		$("#errormsg").append("Invalid Email Verification");
    	
    	if(error == 'session')
    		$("#errormsg").append("Session timed out. Try Again!");
    	
    	setCookie('conferror',"",-1);
   
    	
    	var errormsg = getCookie('errormsg');
    	$("#errormsg").append(errormsg);
    	setCookie('errormsg',"",-1);
   
      gapi.load('auth2,signin2', function() {
        var auth2 = gapi.auth2.init();
        auth2.then(function() {
          // Current values
          var isSignedIn = auth2.isSignedIn.get();
          var currentUser = auth2.currentUser.get();

          if (!isSignedIn) {
        	  state = 1;  //not signed in
            gapi.signin2.render('google-signin-button', {
              'onsuccess': 'onSignIn'  
            });
          }
          else
          {
        	  signOut();
        	  state =2; //sign him out
        	  gapi.signin2.render('google-signin-button', {
                  'onsuccess': 'onSignIn'  
                });
          }
        });
      });
    }

    function signOut() {
      var auth2 = gapi.auth2.getAuthInstance();
      auth2.signOut().then(function () {
    	  alert("user logged out");
        console.log('User signed out.');
      });
    }
    
 
    
    
    
  </script>


</html>
