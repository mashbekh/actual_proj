<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Sign In</title>
  
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script src="http://ajax.aspnetcdn.com/ajax/jquery.ui/1.9.1/jquery-ui.js" type="text/javascript"></script>
<meta name="google-signin-client_id"
	content="230903295209-qfhj977v4aa60i0sjthdd0nuc0u1fkga.apps.googleusercontent.com">
<link href="http://ajax.aspnetcdn.com/ajax/jquery.ui/1.9.1/themes/blitzer/jquery-ui.css"
    rel="stylesheet" type="text/css" />
    
    
  <script src="https://apis.google.com/js/platform.js" async defer></script>
    


  
<link rel="stylesheet" href="jarvis/js/datatables/responsive/css/datatables.responsive.css">

    <!-- Bootstrap Core CSS -->
    <link href="jarvis/css1/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="jarvis/css1/sb-admin.css" rel="stylesheet">

    <!-- Morris Charts CSS -->
    <link href="jarvis/css1/plugins/morris.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="jarvis/css/font-icons/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    
    <link rel="stylesheet" href="jarvis/css/font-icons/entypo/css/entypo.css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->



</head>
<script>
function setCookie(key, value, days) {
    var expires = new Date();
    expires.setTime(expires.getTime() + (days * 24 * 60 * 60 * 1000));
    document.cookie = key + '=' + value + ';expires=' + expires.toUTCString();
}
     

function getCookie(key) {
    var keyValue = document.cookie.match('(^|;) ?' + key + '=([^;]*)(;|$)');
    return keyValue ? keyValue[2] : null;
}

$(document).ready(function () {
    var $inputs = $("#login input");
    
    $inputs.on("input change", function () {
        valid = true;
        $inputs.each(function () {
           
            valid *= this.type == "radio" ? this.checked : this.value != "";
            return valid;
        });    
        $("#submit").prop("disabled", !valid);
    });
});

</script>
<style>

#abc{
  background-color: #F0F3F4;
   margin-top: 15px;
}


#xyz
{
    height: 65px;
     text-align: center;
    
     background-color:#152F37;
}

#pqr{
     background-color:#152F37;

}

#wrapper{
     background-color:white;

}
.ui-dialog-titlebar {
    border: 0;
    padding: .5em 1em;
    background: black;
    overflow: auto;
    zoom: 1;
}
</style>

<body onload="renderButton()">

    <div id="wrapper">

        <!-- Navigation -->
        <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation" id="pqr">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header" id="xyz">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                
                <a class="navbar-brand" href="index.html" id="xyz" >SIMPLIFY TAX</a>
            </div>
            <!-- Top Menu Items -->
            <ul class="nav navbar-right top-nav" id="pqr">
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-envelope"></i> <b class="caret"></b></a>
                    <ul class="dropdown-menu message-dropdown">
                        <li class="message-preview">
                            <a href="#">
                               
                            </a>
                        </li>
                        <li class="message-preview">
                            <a href="#">
                               
                            </a>
                        </li>
                        <li class="message-preview">
                            <a href="#">
                              
                            </a>
                        </li>
                        <li class="message-footer">
                            <a href="#">Read All New Messages</a>
                        </li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-bell"></i> <b class="caret"></b></a>
                    <ul class="dropdown-menu alert-dropdown">
                        <li>
                            <a href="#">Alert Name <span class="label label-default">Alert Badge</span></a>
                        </li>
                        <li>
                            <a href="#">Alert Name <span class="label label-primary">Alert Badge</span></a>
                        </li>
                        <li>
                            <a href="#">Alert Name <span class="label label-success">Alert Badge</span></a>
                        </li>
                        <li>
                            <a href="#">Alert Name <span class="label label-info">Alert Badge</span></a>
                        </li>
                        <li>
                            <a href="#">Alert Name <span class="label label-warning">Alert Badge</span></a>
                        </li>
                        <li>
                            <a href="#">Alert Name <span class="label label-danger">Alert Badge</span></a>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <a href="#">View All</a>
                        </li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-user"></i> John Smith <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        <li>
                            <a href="#"><i class="fa fa-fw fa-user"></i> Profile</a>
                        </li>
                        <li>
                            <a href="#"><i class="fa fa-fw fa-envelope"></i> Inbox</a>
                        </li>
                        <li>
                            <a href="#"><i class="fa fa-fw fa-gear"></i> Settings</a>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <a href="#"><i class="fa fa-fw fa-power-off"></i> Log Out</a>
                        </li>
                    </ul>
                </li>
            </ul>

          
            <!-- /.navbar-collapse -->
        </nav>


        <div id="page-wrapper">

            <div class="container-fluid">

  
                        <h1 class="page-header">
                            Login <small>&nbsp; &nbsp;&nbsp;&nbsp;Need an account? <a href="register.html">Sign up now!</a></small>
                        </h1>
                        <p id="content">
                        
                        </p>
                        
                        <div class="row">
                    <div class="col-lg-6">
                     
                        
                        <div id="form-panel">
                        <div class="row">
                        <div class="col-lg-12">
                        <form role="form" id="login">
                        
                            <div class="form-group">
                                <label></label>
                                <input class="form-control" type="text" id="email" placeholder="Email" onchange="return verify_mail()" required>
                                <div id="email_msg"></div>
                            </div>

                            <div class="form-group">
                                <label></label>
                                <input class="form-control" type="password" id="password" placeholder="Password" required>
                            </div>
                            
                             <button type="submit" class="btn btn-primary" id="submit" onclick="return verify(this,event)" disabled="disabled">Lets get started!</button>
                                <script>
                              
function verify_mail()
{
 var reg = /^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;
var x= document.getElementById("email").value;
if(reg.test(x)== false)
 {
 
 $('#email_msg').text("Please enter valid email address");
 return false;
 }
else return true;

}
                              
function setCookie(key, value, days) {
    var expires = new Date();
    expires.setTime(expires.getTime() + (days * 24 * 60 * 60 * 1000));
    document.cookie = key + '=' + value + ';expires=' + expires.toUTCString();
}
     

function getCookie(key) {
    var keyValue = document.cookie.match('(^|;) ?' + key + '=([^;]*)(;|$)');
    return keyValue ? keyValue[2] : null;
}                          
                              
    function verify(sender,e){
    
    var email = $('#email').val();
	var password  = $('#password').val();
	e.preventDefault();
	
   $.ajax({
   		type : 'POST',
   		url  : '/Accounting/rest/login/verify?' + $.param({'email': email, 'password': password, 'type':1}),
    	dataType :'text',
    	
    		success: function(response, text, xhr) {
    			
    			var data = xhr.responseText.split('*');
    			var name = data[0];
    			var id = data[1];
    			var token = data[2];
    			
    			setCookie('NID',name,1);
    			setCookie('SID',id,1);
    			setCookie('TTID',token,1);
    			
     
    		},
    
	  
			error: function (xhr, statusText)
			{ 
				var errorCode = xhr.status;
				if(errorCode == 404  )
					{
					 setCookie('errormsg',"Invalid email or password. Please try again!",1);
				   	 window.location.replace("login.html");
					}
				if(errorCode == 512  || errorCode == 513 || errorCode == 514  || errorCode == 515 || errorCode == 500)
					{
						setCookie('errormsg',"Oops! Something went wrong. Please try again!",1);
				   	 	window.location.replace("login.html");
					}
			
			}  
	  });
}
                              
                              </script>
                            
                             <p>-------------or-------------</p>
                            <div class="form-group">
                             <div  id="google-signin-button"></div>
                             
                             
 <script>
 
 var count=0; 
 var state;
function onSignIn(googleUser) 
{
	// state = 1,  not signedin earlier  & state = 2 signed in earlier
	count= count+1;
	
	if( state ==2 && count!=1 || state == 1)  //count is 2
	{
		
		alert('Logged in as: ' + googleUser.getBasicProfile().getName());
		var name = googleUser.getBasicProfile().getName();
   		var email = googleUser.getBasicProfile().getEmail();
		
   		$.ajax({
			type : 'POST',
			url  : '/Accounting/rest/login/verify?' + $.param({'email': email, 'password': null, 'type':2}),
 			dataType : "text",

		success: function(response, text, xhr) {
        

			var data = xhr.responseText.split('*');
			var name = data[0];
			var id = data[1];
			var token = data[2];
			
			setCookie('NID',name,1);
			setCookie('SID',id,1);
			setCookie('TTID',token,1);   
			
			window.location.replace("business_details.html");
			
 },
 
 error: function (xhr, statusText) {
	 
	 var errorCode = xhr.status;
		if(errorCode == 404  )
			{
			 setCookie('errormsg',"Invalid login. Please try again!",1);
		   	 window.location.replace("login.html");
			}
		if(errorCode == 512  || errorCode == 513 || errorCode == 514  || errorCode == 515 || errorCode == 500)
			{
				setCookie('errormsg',"Oops! Something went wrong. Please try again!",1);
		   	 	window.location.replace("login.html");
			}

	   return false;
	  }
 
	  });
		
	  }
}



function onFailure(error) {
 console.log(error);
}
function renderButton() {
	
	//clear all other cookies
	
	setCookie('email',"",-1);
	setCookie('newemail',"",-1);
	setCookie('mobile',"",-1);
	setCookie('identifier',"",-1);
	setCookie('mailCode',"",-1);
	setCookie('mobCode',"",-1);
	setCookie('newphone',"",-1);
	setCookie('NID',"",-1);
	setCookie('SID',"",-1);
	setCookie('TTID',"",-1);   
	
	
	//errors coming up from confirmation failures

	var error = getCookie('conferror');
	if(error == 'notfound')
		$("#errormsg").append("Invalid Email Verification");
	
	if(error == 'session')
		$("#errormsg").append("Session timed out. Try Again!");
	
	setCookie('conferror',"",-1);
	
	

	//in case of op on google signup fail, reload register and show error msg
	var errormsg = getCookie('errormsg');
	$("#errormsg").append(errormsg);
	setCookie('errormsg',"",-1);
	
	

	 gapi.load('auth2,signin2', function() {
   var auth2 = gapi.auth2.init();
   auth2.then(function() {
     // Current values
     var isSignedIn = auth2.isSignedIn.get();
     var currentUser = auth2.currentUser.get();

     if (!isSignedIn) {
   	  state = 1;  //not signed in
       gapi.signin2.render('google-signin-button', {
         'onsuccess': 'onSignIn'  
       });
     }
     else
     {
   	  signOut();
   	  state =2; //sign him out
   	  gapi.signin2.render('google-signin-button', {
             'onsuccess': 'onSignIn'  
           });
     }
   });
 });
}

function signOut() {
 var auth2 = gapi.auth2.getAuthInstance();
 auth2.signOut().then(function () {
	  alert("user logged out");
   console.log('User signed out.');
 });
}

 
    
    
    
  </script>
                        </div>
                        
                         </form>
                        <div>
                        </div>
                        </div>
                        
                      
                    </div>
                </div>
                <!-- /.row -->
</div> <!--  wrapper -->
               
            </div>
            <!-- /.container-fluid -->

        </div>
        <!-- /#page-wrapper -->


    <!-- jQuery 
    <script src="js/jquery.js"></script>-->

    <!-- Bootstrap Core JavaScript -->
    <script src="jarvis/js/bootstrap.min.js"></script>

    <!-- Morris Charts JavaScript -->
    <script src="jarvis/js1/plugins/morris/raphael.min.js"></script>
    <script src="jarvis/js1/plugins/morris/morris.min.js"></script>
    <script src="jarvis/js1/plugins/morris/morris-data.js"></script>

</body>


</html>
